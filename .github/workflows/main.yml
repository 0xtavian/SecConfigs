name: SecConfigs 

on: [push]

jobs:
  sec-configs:
    runs-on: ubuntu-latest
    continue-on-error: true 
    steps:
     - uses: actions/checkout@v2
     - run: |
        echo "Installing Nuclei"
        GO111MODULE=on go get github.com/projectdiscovery/nuclei/v2/cmd/nuclei@latest
        echo "Installing Subfinder"
        GO111MODULE=on go get github.com/projectdiscovery/subfinder/v2/cmd/subfinder@latest
        echo "Installing Naabu"
        sudo apt-get update && sudo apt-get install -y libpcap-dev -y
        GO111MODULE=on go get github.com/projectdiscovery/naabu/v2/cmd/naabu@v2.0.4
        echo "downloading amass config from master repo"
        wget https://raw.githubusercontent.com/OWASP/Amass/master/examples/config.ini amassconfig.ini
        echo "downloading findomain config from master repo"
        git clone https://github.com/Findomain/Findomain/tree/master/config_examples findomain
        echo "/home/runner/go/bin/" >> $GITHUB_PATH
        echo http://scanme.nmap.org | /home/runner/go/bin/nuclei 
        echo scanme.nmap.org | /home/runner/go/bin/subfinder 
        echo http://scanme.nmap.org | /home/runner/go/bin/naabu 
        cp /home/runner/.config/nuclei/config.yaml $GITHUB_WORKSPACE/nuclei.yaml
        cp /home/runner/.config/subfinder/config.yaml $GITHUB_WORKSPACE/subfinder.yaml
        cp /home/runner/.config/naabu/naabu.conf $GITHUB_WORKSPACE/naabu.conf
        git config --local user.name "node"
        git config --local user.email "node"
        git remote set-url origin https://x-access-token:${{ secrets.GITHUB_TOKEN }}@github.com/$GITHUB_REPOSITORY
        git checkout "${GITHUB_REF:11}"
        git add $GITHUB_WORKSPACE/nuclei.yaml $GITHUB_WORKSPACE/subfinder.yaml $GITHUB_WORKSPACE/naabu.conf
        git commit -am "Configs uploaded"
        git push
